<!DOCTYPE html>
<html>

<head>
    <title>(ArgelH-Subs)</title>
    <link rel="icon" href="https://i.imgur.com/yDkaBI1.png" />
    <style>
        html {
            font-family: "Times New Roman", Times, serif;
            font-size: 62.5%;
        }

        body {
            font-size: 3.2rem;
        }

        #contents {
            margin-top: 1rem;
        }

        .dir {
            color: blue;
            cursor: pointer;
        }

        .file {
            color: blue;
            text-decoration: underline;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="path"></div>
    <div id="contents"></div>
    <script>
        fetch('tree.json')
            .then(response => response.json())
            .then(data => {
                const contents = document.querySelector('#contents');
                const path = document.querySelector('#path');

                function renderContents(node) {
    contents.innerHTML = '';

    // Add parent directory link
    if (node.path.length > 1) {
        const parent = document.createElement('div');
        parent.innerText = 'â¤´ ðŸ“‚ ..';
        parent.classList.add('dir');
        parent.addEventListener('click', () => {
            const parentPath = node.path.slice(0, -1);
            renderContents(findNodeByPath(parentPath));
            renderPath(parentPath);
        });
        contents.appendChild(parent);
    }

    node.children.forEach(child => {
        const element = document.createElement('div');
        if (child.type === 'directory') {
            element.innerText = `â†ª ðŸ“ ${child.name}`;
            element.classList.add('dir');
            element.addEventListener('click', () => {
                const childPath = node.path.concat(child.name);
                renderContents(findNodeByPath(childPath));
                renderPath(childPath);
            });
        } else {
            element.innerText = `â†ª ðŸ“„ ${child.name}`;
            element.classList.add('file');
            element.addEventListener('click', () => {
                window.open(child.url, '_blank');
            });
        }
        contents.appendChild(element);
    });
}


                function findNodeByPath(path) {
                    let currentNode = data;
                    for (let i = 1; i < path.length; i++) {
                        const name = path[i];
                        const child = currentNode.children.find(child => child.name === name);
                        if (!child) {
                            return null;
                        }
                        currentNode = child;
                    }
                    return currentNode;
                }

                function renderPath(pathArr) {
                    path.innerHTML = pathArr.map((dir, i) => {
                        if (i === 0) {
                            return dir;
                        }
                        const dirPath = pathArr.slice(0, i + 1);
                        const link = document.createElement('span');
                        link.innerText = ` / ${dir}`;
                        if (i === pathArr.length - 1) {
                            link.style.fontWeight = 'bold';
                        } else {
                            link.classList.add('dir');
                            link.style.cursor = 'pointer';
                            link.addEventListener('click', () => {
                                renderContents(findNodeByPath(dirPath));
                                renderPath(dirPath);
                            });
                        }
                        return link.outerHTML;
                    }).join('');
                }

                renderContents(data);
                renderPath(data.path);
            });
    </script>
</body>

</html>
